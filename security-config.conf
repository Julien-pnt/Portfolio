# =================================================================
# CONFIGURATION DE SÉCURITÉ PORTFOLIO JULIEN PINOT
# Fichier de monitoring et protection avancée
# =================================================================

# LISTE DES ADRESSES IP BLOQUÉES (à maintenir)
# Format: IP_ADDRESS REASON DATE
# Exemple: 192.168.1.100 "Tentative injection SQL" 2024-09-06

# IPs suspectes communes
0.0.0.0/8           "Adresse invalide"
127.0.0.0/8         "Loopback local"
169.254.0.0/16      "APIPA range"
224.0.0.0/4         "Multicast"

# User Agents malveillants à bloquer
BLOCKED_USER_AGENTS=(
    "sqlmap"
    "nikto"
    "nmap"
    "w3af"
    "dirbuster"
    "gobuster"
    "masscan"
    "nuclei"
    "httpx"
    "subfinder"
)

# Extensions de fichiers interdites
BLOCKED_EXTENSIONS=(
    ".php"
    ".asp"
    ".aspx"
    ".jsp"
    ".cgi"
    ".pl"
    ".py"
    ".sh"
    ".bat"
    ".exe"
    ".dll"
    ".so"
)

# Patterns d'attaque XSS à détecter
XSS_PATTERNS=(
    "<script"
    "</script>"
    "javascript:"
    "vbscript:"
    "onload="
    "onerror="
    "onclick="
    "onmouseover="
    "eval("
    "alert("
    "document.cookie"
    "document.location"
)

# Patterns d'injection SQL à détecter
SQL_PATTERNS=(
    "union select"
    "' or '1'='1"
    "' or 1=1"
    "' union"
    "select * from"
    "drop table"
    "insert into"
    "delete from"
    "update set"
    "exec("
    "sp_"
)

# Patterns de Directory Traversal
TRAVERSAL_PATTERNS=(
    "../"
    "..\"
    "..%2f"
    "..%5c"
    "%2e%2e%2f"
    "%2e%2e%5c"
    "/etc/"
    "/var/"
    "/usr/"
    "/windows/"
    "/system32/"
)

# Headers de sécurité requis
REQUIRED_HEADERS=(
    "Content-Security-Policy"
    "X-Content-Type-Options"
    "X-Frame-Options"
    "X-XSS-Protection"
    "Strict-Transport-Security"
    "Referrer-Policy"
)

# Configuration du rate limiting
RATE_LIMIT_REQUESTS=50          # Nombre max de requêtes
RATE_LIMIT_WINDOW=60            # Fenêtre de temps en secondes
RATE_LIMIT_BAN_TIME=300         # Durée du bannissement en secondes

# Configuration des logs de sécurité
LOG_LEVEL="INFO"
LOG_FILE="/var/log/portfolio_security.log"
LOG_RETENTION_DAYS=30

# Alertes email (à configurer en production)
ALERT_EMAIL="admin@portfolio-julien.com"
SMTP_SERVER="localhost"
SMTP_PORT=587

# Configuration backup
BACKUP_FREQUENCY="daily"
BACKUP_RETENTION=7
BACKUP_LOCATION="/backup/portfolio/"

# Checksum des fichiers critiques (à mettre à jour après modifications)
FILE_CHECKSUMS=(
    "index.html:sha256:..."
    "security.js:sha256:..."
    ".htaccess:sha256:..."
)

# Configuration SSL/TLS (pour production)
SSL_CERTIFICATE_PATH="/etc/ssl/certs/portfolio.crt"
SSL_PRIVATE_KEY_PATH="/etc/ssl/private/portfolio.key"
SSL_CIPHER_SUITE="ECDHE-RSA-AES256-GCM-SHA384"
SSL_PROTOCOLS="TLSv1.2 TLSv1.3"

# Timeouts de sécurité
SESSION_TIMEOUT=1800            # 30 minutes
COOKIE_LIFETIME=3600            # 1 heure
CSRF_TOKEN_LIFETIME=900         # 15 minutes

# Politique de mots de passe (si applicable)
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# Configuration de l'audit
AUDIT_LOGIN_ATTEMPTS=true
AUDIT_FILE_ACCESS=true
AUDIT_ADMIN_ACTIONS=true
AUDIT_FAILED_REQUESTS=true

# Notifications de sécurité
NOTIFY_FAILED_LOGIN=true
NOTIFY_SUSPICIOUS_ACTIVITY=true
NOTIFY_FILE_CHANGES=true
NOTIFY_NEW_VULNERABILITIES=true
